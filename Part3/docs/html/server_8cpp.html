<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: server.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">server.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A simple multi-threaded server that processes client requests using the RESP (REdis Serialization Protocol). The server handles SET and GET commands, stores data, and uses <code>epoll</code> for scalable I/O handling.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cstring&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;sys/epoll.h&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;mutex&gt;</code><br />
<code>#include &lt;queue&gt;</code><br />
<code>#include &lt;atomic&gt;</code><br />
<code>#include &lt;condition_variable&gt;</code><br />
<code>#include &quot;REPL.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for server.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="server_8cpp__incl.png" border="0" usemap="#aserver_8cpp" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structClientContext.html">ClientContext</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maintains the context and state of each connected client.  <a href="structClientContext.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadPool.html">ThreadPool</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple thread pool to handle client connections concurrently.  <a href="classThreadPool.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae42954bb8545d24e3e9dcde5920c9a0b" id="r_ae42954bb8545d24e3e9dcde5920c9a0b"><td class="memItemLeft" align="right" valign="top"><a id="ae42954bb8545d24e3e9dcde5920c9a0b" name="ae42954bb8545d24e3e9dcde5920c9a0b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_EVENTS</b>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:ae42954bb8545d24e3e9dcde5920c9a0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of events that can be handled at once by epoll. <br /></td></tr>
<tr class="separator:ae42954bb8545d24e3e9dcde5920c9a0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b20d41d6252e9871430c242cb1a56e7" id="r_a6b20d41d6252e9871430c242cb1a56e7"><td class="memItemLeft" align="right" valign="top"><a id="a6b20d41d6252e9871430c242cb1a56e7" name="a6b20d41d6252e9871430c242cb1a56e7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BUFFER_SIZE</b>&#160;&#160;&#160;4096</td></tr>
<tr class="memdesc:a6b20d41d6252e9871430c242cb1a56e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer size for receiving data from the client. <br /></td></tr>
<tr class="separator:a6b20d41d6252e9871430c242cb1a56e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a614217d263be1fb1a5f76e2ff7be19a2" id="r_a614217d263be1fb1a5f76e2ff7be19a2"><td class="memItemLeft" align="right" valign="top"><a id="a614217d263be1fb1a5f76e2ff7be19a2" name="a614217d263be1fb1a5f76e2ff7be19a2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PORT</b>&#160;&#160;&#160;6379</td></tr>
<tr class="memdesc:a614217d263be1fb1a5f76e2ff7be19a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Port number on which the server listens. <br /></td></tr>
<tr class="separator:a614217d263be1fb1a5f76e2ff7be19a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afad9eb7393cb103c5d29a738485b82b0" id="r_afad9eb7393cb103c5d29a738485b82b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8cpp.html#afad9eb7393cb103c5d29a738485b82b0">set_nonblocking</a> (int fd)</td></tr>
<tr class="memdesc:afad9eb7393cb103c5d29a738485b82b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a socket to non-blocking mode.  <br /></td></tr>
<tr class="separator:afad9eb7393cb103c5d29a738485b82b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1fe471bae7b17bebbd8854ff4e80fb6" id="r_ab1fe471bae7b17bebbd8854ff4e80fb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8cpp.html#ab1fe471bae7b17bebbd8854ff4e80fb6">send_response</a> (int fd, const std::string &amp;response)</td></tr>
<tr class="memdesc:ab1fe471bae7b17bebbd8854ff4e80fb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a response to the client.  <br /></td></tr>
<tr class="separator:ab1fe471bae7b17bebbd8854ff4e80fb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f6d1713d1c853df17a61f7e6699f46a" id="r_a6f6d1713d1c853df17a61f7e6699f46a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8cpp.html#a6f6d1713d1c853df17a61f7e6699f46a">handle_client</a> (<a class="el" href="structClientContext.html">ClientContext</a> &amp;ctx)</td></tr>
<tr class="memdesc:a6f6d1713d1c853df17a61f7e6699f46a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the client's requests, parsing commands and interacting with the REPL data store. This function is responsible for parsing the RESP commands from the client, executing commands like "SET" and "GET", and sending responses back to the client.  <br /></td></tr>
<tr class="separator:a6f6d1713d1c853df17a61f7e6699f46a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed460147c66671ccbaf5d1f285ccefb" id="r_a0ed460147c66671ccbaf5d1f285ccefb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8cpp.html#a0ed460147c66671ccbaf5d1f285ccefb">SIGHANDLER</a> (int sig)</td></tr>
<tr class="memdesc:a0ed460147c66671ccbaf5d1f285ccefb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signal handler to cleanly shut down the server on SIGINT (Ctrl+C). This function cleans up resources when the server is interrupted and exits the program.  <br /></td></tr>
<tr class="separator:a0ed460147c66671ccbaf5d1f285ccefb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4" id="r_ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="memdesc:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main entry point for the server application. This function sets up the server socket, listens for incoming client connections, and uses <code>epoll</code> to handle multiple clients concurrently. It also processes client commands using the thread pool for parallel execution.  <br /></td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acdf971a92301077b295003afdf6b7883" id="r_acdf971a92301077b295003afdf6b7883"><td class="memItemLeft" align="right" valign="top"><a id="acdf971a92301077b295003afdf6b7883" name="acdf971a92301077b295003afdf6b7883"></a>
atomic_flag&#160;</td><td class="memItemRight" valign="bottom"><b>flag</b> = ATOMIC_FLAG_INIT</td></tr>
<tr class="memdesc:acdf971a92301077b295003afdf6b7883"><td class="mdescLeft">&#160;</td><td class="mdescRight">Atomic flag used for synchronization between threads. <br /></td></tr>
<tr class="separator:acdf971a92301077b295003afdf6b7883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4dc83dd0d4f2e3b60c7b0660a4a430" id="r_aef4dc83dd0d4f2e3b60c7b0660a4a430"><td class="memItemLeft" align="right" valign="top"><a id="aef4dc83dd0d4f2e3b60c7b0660a4a430" name="aef4dc83dd0d4f2e3b60c7b0660a4a430"></a>
REPL&#160;</td><td class="memItemRight" valign="bottom"><b>r</b></td></tr>
<tr class="memdesc:aef4dc83dd0d4f2e3b60c7b0660a4a430"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global REPL object for storing key-value pairs in memory. <br /></td></tr>
<tr class="separator:aef4dc83dd0d4f2e3b60c7b0660a4a430"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A simple multi-threaded server that processes client requests using the RESP (REdis Serialization Protocol). The server handles SET and GET commands, stores data, and uses <code>epoll</code> for scalable I/O handling. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6f6d1713d1c853df17a61f7e6699f46a" name="a6f6d1713d1c853df17a61f7e6699f46a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f6d1713d1c853df17a61f7e6699f46a">&#9670;&#160;</a></span>handle_client()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void handle_client </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structClientContext.html">ClientContext</a> &amp;&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles the client's requests, parsing commands and interacting with the REPL data store. This function is responsible for parsing the RESP commands from the client, executing commands like "SET" and "GET", and sending responses back to the client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The client context containing the state and data for the client </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4" name="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main entry point for the server application. This function sets up the server socket, listens for incoming client connections, and uses <code>epoll</code> to handle multiple clients concurrently. It also processes client commands using the thread pool for parallel execution. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

</div>
</div>
<a id="ab1fe471bae7b17bebbd8854ff4e80fb6" name="ab1fe471bae7b17bebbd8854ff4e80fb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1fe471bae7b17bebbd8854ff4e80fb6">&#9670;&#160;</a></span>send_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_response </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a response to the client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>The file descriptor of the client socket </td></tr>
    <tr><td class="paramname">response</td><td>The response message to send to the client </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afad9eb7393cb103c5d29a738485b82b0" name="afad9eb7393cb103c5d29a738485b82b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afad9eb7393cb103c5d29a738485b82b0">&#9670;&#160;</a></span>set_nonblocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_nonblocking </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets a socket to non-blocking mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>The file descriptor of the socket </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ed460147c66671ccbaf5d1f285ccefb" name="a0ed460147c66671ccbaf5d1f285ccefb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed460147c66671ccbaf5d1f285ccefb">&#9670;&#160;</a></span>SIGHANDLER()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SIGHANDLER </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Signal handler to cleanly shut down the server on SIGINT (Ctrl+C). This function cleans up resources when the server is interrupted and exits the program. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sig</td><td>The signal number (ignored in this implementation) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
